{% extends "shared/base.html" %} {% block style %}
<style>
  .category-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: #f0f0f0;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 10px;
  }

  .category-name {
    font-size: 12px;
    margin-top: 5px;
    text-align: center;
  }

  .restaurant-card img {
    width: 100%;
    height: auto;
  }

  .restaurant-card {
    margin-top: 20px;
  }

  .menu-item img {
    width: 100%;
    border-radius: 10px;
  }

  .category-btns {
    margin-bottom: 20px;
  }

  .price {
    color: green;
  }

  /* Responsive styles */
</style>

{% endblock style %}
<!--客製化區塊-->
{% block content %}
<!--Google 地圖-->
<h3>google map測試</h3>
<div style="display: flex;">
  <div id="map" style="width: 50%; height: 50vh;"></div>
</div>
<!--banner-->
<div
  class="category-container d-flex flex-wrap justify-content-center container-fluid"
>

  <!-- Category Buttons -->
  <div class="category-btns">
    <button class="btn btn-outline-primary category-btn" data-category="lunch">
      <div class="text-center">
        <div class="category-icon">
          <img src="https://via.placeholder.com/40" alt="Main Dishes" />
        </div>
        <p class="category-name">古早味</p>
      </div>
    </button>
    <button class="btn btn-outline-primary category-btn" data-category="salad">
      <div class="text-center">
        <div class="category-icon">
          <img src="https://via.placeholder.com/40" alt="BBQ" />
        </div>
        <p class="category-name">韓式料理</p>
      </div>
    </button>
    <button class="btn btn-outline-primary category-btn" data-category="burger">
      <div class="text-center">
        <div class="category-icon">
          <img src="https://via.placeholder.com/40" alt="Vegan" />
        </div>
        <p class="category-name">日本料理</p>
      </div>
    </button>
    <button class="btn btn-outline-primary category-btn" data-category="coffee">
      <div class="text-center">
        <div class="category-icon">
          <img src="https://via.placeholder.com/40" alt="Drinks" />
        </div>
        <p class="category-name">飲品</p>
      </div>
    </button>
    <button
      class="btn btn-outline-primary category-btn"
      data-category="dessert"
    >
      <div class="text-center">
        <div class="category-icon">
          <img src="https://via.placeholder.com/40" alt="Desserts" />
        </div>
        <p class="category-name">冰品/甜點</p>
      </div>
    </button>
  </div>
</div>
  <!-- Recommended Restaurants Section -->
  <h3>美味的雲端餐廳</h3>
  <div class="row" id="menu-items">
    <!-- Menu Items -->
  </div>
</div>

{% endblock content %}<!-- 客製化other_element 區塊  end-->
{% block script %}
<script>
  const menuData = {
    lunch: [
      {
        name: "七彩雲南",
        price: "$16.50",
        img: "https://via.placeholder.com/150",
        time: "16 mins to cook",
      },
      {
        name: "韓國大叔",
        price: "$12.40",
        img: "https://via.placeholder.com/150",
        time: "16 mins to cook",
      },
      {
        name: "Chef's Salmon",
        price: "$12.40",
        img: "https://via.placeholder.com/150",
        time: "16 mins to cook",
      },
      {
        name: "Chef's Salmon",
        price: "$12.40",
        img: "https://via.placeholder.com/150",
        time: "16 mins to cook",
      },
    ],
    salad: [
      {
        name: "Caesar Salad",
        price: "$8.50",
        img: "https://via.placeholder.com/150",
        time: "10 mins to cook",
      },
      {
        name: "Greek Salad",
        price: "$9.00",
        img: "https://via.placeholder.com/150",
        time: "12 mins to cook",
      },
      {
        name: "Greek Salad",
        price: "$9.00",
        img: "https://via.placeholder.com/150",
        time: "12 mins to cook",
      },
      {
        name: "Greek Salad",
        price: "$9.00",
        img: "https://via.placeholder.com/150",
        time: "12 mins to cook",
      },
    ],
    burger: [
      {
        name: "Cheeseburger",
        price: "$7.50",
        img: "https://via.placeholder.com/150",
        time: "15 mins to cook",
      },
      {
        name: "Veggie Burger",
        price: "$8.00",
        img: "https://via.placeholder.com/150",
        time: "12 mins to cook",
      },
      {
        name: "Veggie Burger",
        price: "$8.00",
        img: "https://via.placeholder.com/150",
        time: "12 mins to cook",
      },
      {
        name: "Veggie Burger",
        price: "$8.00",
        img: "https://via.placeholder.com/150",
        time: "12 mins to cook",
      },
    ],
    coffee: [
      {
        name: "Latte",
        price: "$4.50",
        img: "https://via.placeholder.com/150",
        time: "5 mins to brew",
      },
      {
        name: "Cappuccino",
        price: "$4.00",
        img: "https://via.placeholder.com/150",
        time: "5 mins to brew",
      },
      {
        name: "Cappuccino",
        price: "$4.00",
        img: "https://via.placeholder.com/150",
        time: "5 mins to brew",
      },
      {
        name: "Cappuccino",
        price: "$4.00",
        img: "https://via.placeholder.com/150",
        time: "5 mins to brew",
      },
    ],
    dessert: [
      {
        name: "Chocolate Cake",
        price: "$5.50",
        img: "https://via.placeholder.com/150",
        time: "20 mins to prepare",
      },
      {
        name: "Ice Cream Sundae",
        price: "$4.50",
        img: "https://via.placeholder.com/150",
        time: "10 mins to prepare",
      },
      {
        name: "Chocolate Cake",
        price: "$5.50",
        img: "https://via.placeholder.com/150",
        time: "20 mins to prepare",
      },
      {
        name: "Chocolate Cake",
        price: "$5.50",
        img: "https://via.placeholder.com/150",
        time: "20 mins to prepare",
      },
    ],
  };

  document.addEventListener("DOMContentLoaded", function () {

    const categoryButtons = document.querySelectorAll(".category-btn");
    const menuContainer = document.getElementById("menu-items");

    // Function to load menu items based on category
    function loadMenuItems(category) {
      menuContainer.innerHTML = ""; // Clear previous content
      const items = menuData[category];

      items.forEach((item) => {
        const menuItem = `
            <div class="col-lg-3 col-md-4 col-12 restaurant-card">
              <div class="card">
                <img
                  src="https://via.placeholder.com/200x200"
                  class="card-img-top"
                  alt="Restaurant 1"
                />
                <div class="card-body">
                  <h5 class="card-title">${item.name}</h5>
                  <p class="card-text">新鮮可口的早餐，開始美好的一天！</p>
                  <a href="{{ url_for('home.restaurant_menu', vendor_id=1)}}" id="menu-btn" class="btn btn-primary" data-id="1" >餐廳菜單</a>
                </div>
          </div>
        </div>
          `;
        menuContainer.innerHTML += menuItem;
      });

    }

    // Load "Lunch" menu by default
    loadMenuItems("lunch");

    // Add event listeners to category buttons
    categoryButtons.forEach((button) => {
      button.addEventListener("click", function () {
        const category = this.getAttribute("data-category");
        loadMenuItems(category);
      });
    });

    //處理地址搜尋框 按鈕事件getLocateBtn
    const getLocateBtn = document.querySelector('#getLocateBtn');
    //console.log(getLocateBtn);
    getLocateBtn.addEventListener('click',function() {
      //console.log('get it')
      //檢查瀏覽器是否支持 Geolocation Api
      if(!navigator.geolocation) {
        alert('當前瀏覽器不支援Geolocation')
        return;
      }
      //取的使用者當前地理位置
      navigator.geolocation.getCurrentPosition(function(position) {
        //console.log(position)
        const { latitude } = position.coords
        const { longitude } = position.coords
      }, function() {
        alert('無法取得你目前的位置')
      })
    });

   
    

      //點擊按鈕 => GET MENU
    //const getVendorMenu = document.getElementById('menu-btn')
    //console.log(getVendorMenu)

    //getVendorMenu.addEventListener("click", function() {
     // const vendorMenuId = getVendorMenu.dataset.id;
     // window.location.href = `/restaurantMenu`;
    //});
  });
  
</script>
<!-- 使用從 Flask 傳遞過來的 my_key 變量 -->

<script>(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})
        ({key: "{{ my_key }}", v: "weekly"});</script>
 <script>
  let map;
  let currentPosition;

    async function initMap() {
      // 預設位置經緯度
      const defaultPosition = { lat: 24.8421033, lng:118.992123 };

      const { Map } = await google.maps.importLibrary("maps");
      const { AdvancedMarkerElement } = await google.maps.importLibrary("marker");

      // 初始化地圖，置中到預設位置
      map = new Map(document.querySelector('#map'), {
        center: defaultPosition,
        zoom: 7,
        mapId: "YOUR_MAP_ID_HERE" 
      });

      // 更新地圖中心為使用者當前位置
        map.setCenter(currentPosition);
        map.setZoom(16);

        // 添加使用者當前位置的標記
        const marker = new AdvancedMarkerElement({
          map: map,
          position: currentPosition,  // 使用當前位置，而不是預設位置
          title: "你在這裡"
        });
      // 取得使用者當前地理位置
      navigator.geolocation.getCurrentPosition(function(position) {
        currentPosition = {
            lat: position.coords.latitude,
            lng: position.coords.longitude,
        };

        // 更新地圖中心為使用者當前位置
        map.setCenter(currentPosition);
        map.setZoom(16);

        // 添加使用者當前位置的標記
        const marker = new AdvancedMarkerElement({
          map: map,
          position: currentPosition,  // 使用當前位置，而不是預設位置
          title: "你在這裡"
        });
    });
    }

    initMap();
</script>
{% endblock script %}
